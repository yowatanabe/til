# The maximum number of manual DB snapshots

## RDSの自動バックアップ機能で取得したスナップショットの保存期間

RDSの自動バックアップ機能で取得したスナップショットの保存期間は最大で35日まで。

35日以上保存したい場合は自動バックアップ機能で取得したスナップショットをコピーする。

*[Amazon RDS DB インスタンスの自動スナップショットを長期間保持するにはどうすればよいですか?](https://repost.aws/ja/knowledge-center/rds-automated-snapshot-retain-longer)*

## 手動スナップショットのクォータ

コピーしたスナップショットは手動スナップショットとして保存される。

RDSの手動スナップショット数にはクォータがある。デフォルトのクォータ値は100であるため必要に応じてクォータの上限緩和申請を行う。

*[Amazon RDS のクォータと制約](https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/CHAP_Limits.html)*

## クォータ値の見積もり例

スナップショットを取得するDBクラスター数や手動スナップショットをいつまで保存するかなどを目安に見積もる。

例として以下の要件があるとする。

- 3台のDBクラスターが稼働しており、長期保存のためにRDSの自動バックアップ機能で取得したDBクラスターのスナップショットをコピーする
- 月に2回、メンテンナス作業などの時に手動スナップショットを取得する
- 手動スナップショットは1年間保存する
- 1年以上の手動スナップショットは要件上不要なので削除される

以上の要件から見積もるクォータ値を以下のように算出する。

1. RDSの自動バックアップ機能で取得したDBクラスターのスナップショットのコピー数

    DBクラスター数(3) * 1年間の取得数(365) = 1095

1. メンテンナス作業などの時に取得する手動スナップショット数

    DBクラスター数(3) * 1年間の取得数(2 * 12) = 72

1. 取得する手動スナップショットの総数=上限緩和申請を行う際のクォータ値

    1095 + 72 = 1167  # キリが悪いので大抵は1200などに調整して申請する
